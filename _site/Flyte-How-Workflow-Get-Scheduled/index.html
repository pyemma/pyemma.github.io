<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="How Workflow Get Scheduled via Plugins in Flyte" /><meta name="author" content="Coding Monkey" /><meta property="og:locale" content="en" /><meta name="description" content="Reading open source code has been a recommended approach for software engineers to learn. However, in my past 8 years career, I didn’t do a good job on that. After working in a startup for 1 year, I accidentally foster the habit to read open source code XD. In this post, I would like to share one open source project I have been learning recently, and hope you would enjoy this journey as well." /><meta property="og:description" content="Reading open source code has been a recommended approach for software engineers to learn. However, in my past 8 years career, I didn’t do a good job on that. After working in a startup for 1 year, I accidentally foster the habit to read open source code XD. In this post, I would like to share one open source project I have been learning recently, and hope you would enjoy this journey as well." /><link rel="canonical" href="https://pyemma.github.io/Flyte-How-Workflow-Get-Scheduled/" /><meta property="og:url" content="https://pyemma.github.io/Flyte-How-Workflow-Get-Scheduled/" /><meta property="og:site_name" content="Coding Monkey" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-09-12T00:00:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="How Workflow Get Scheduled via Plugins in Flyte" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@pyemma" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Coding Monkey","url":"https://github.com/pyemma"},"dateModified":"2024-10-05T16:53:30-07:00","datePublished":"2024-09-12T00:00:00-07:00","description":"Reading open source code has been a recommended approach for software engineers to learn. However, in my past 8 years career, I didn’t do a good job on that. After working in a startup for 1 year, I accidentally foster the habit to read open source code XD. In this post, I would like to share one open source project I have been learning recently, and hope you would enjoy this journey as well.","headline":"How Workflow Get Scheduled via Plugins in Flyte","mainEntityOfPage":{"@type":"WebPage","@id":"https://pyemma.github.io/Flyte-How-Workflow-Get-Scheduled/"},"url":"https://pyemma.github.io/Flyte-How-Workflow-Get-Scheduled/"}</script><title>How Workflow Get Scheduled via Plugins in Flyte | Coding Monkey</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Coding Monkey"><meta name="application-name" content="Coding Monkey"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/profile.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Coding Monkey</a></h1><p class="site-subtitle fst-italic mb-0">I’m a staff software engineer with rich experience in recommendation system and machine learning infrastructure. I spent my last 8 years in both Big-Tech (Meta & LinkedIn) and startups (Aven), and I’m glad to see if my past experience and learnings could help boost your career growth <br><br> <a href="https://bit.ly/41vi77B"><strong>book a session now</strong></a></p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/pyemma" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['pyemma1991','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>How Workflow Get Scheduled via Plugins in Flyte</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>How Workflow Get Scheduled via Plugins in Flyte</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1726124400" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 12, 2024 </time> </span> <span> Updated <time data-ts="1728172410" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 5, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/pyemma">Coding Monkey</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2184 words" > <em>12 min</em> read</span></div></div><div style="text-align: right;"> <span> <a href="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fpyemma.github.io%2F/Flyte-How-Workflow-Get-Scheduled/&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" class="popup img-link shimmer"><img style="width: inherit;" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fpyemma.github.io%2F/Flyte-How-Workflow-Get-Scheduled/&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" alt="Views" loading="lazy"></a> </span></div></div></header><div class="content"><p>Reading open source code has been a recommended approach for software engineers to learn. However, in my past 8 years career, I didn’t do a good job on that. After working in a startup for 1 year, I accidentally foster the habit to read open source code XD. In this post, I would like to share one open source project I have been learning recently, and hope you would enjoy this journey as well.</p><p>I have been working in ML pipelining for a long time in Meta Ads. However, I didn’t have a comprehensive understanding across the entire stack, especially on how the underlying infra schedule the model training job and execute it over a fleet of machines. Recently, I have been exposed to an open source project: <a href="https://github.com/flyteorg/flyte">Flyte</a>, which is a orchestrator for ML pipeline built on top of Kubernetes. I think this might be a good opportunity for me to gain some deep understanding in this area.</p><p>I have always been a believer of “Learning by Doing”. My ultimate goal on learning this open source code is to implement a simplified version of ML pipeline orchestrator on my own. Next, let’s see what problem we are going to discuss in this post.</p><h2 id="problem"><span class="me-2">Problem</span><a href="#problem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In Flyte, we could use something called <code class="language-plaintext highlighter-rouge">Plugin</code> for distributed training, e.g. <a href="https://github.com/flyteorg/flyte/blob/master/flyteplugins/go/tasks/plugins/k8s/kfoperators/pytorch/pytorch.go">PyTorch Plugin</a>. In this post, we would discuss how these plugins are getting invoked, so that the distributed training job we defined could get executed. In this post, I would simplify the discussion and only laser eye on the main flow, for other important topics such as storage, pipeline definition and compilation, availability and scalability, I plan to defer it to later posts.</p><h2 id="high-level-architecture"><span class="me-2">High level architecture</span><a href="#high-level-architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/flytepropeller_architecture.png" class="popup img-link shimmer"><img src="/assets/flytepropeller_architecture.png" alt="FlytePropeller Design" loading="lazy"></a></p><p>The key component that is responsible for scheduling and monitoring the workflow in Flyte is called <code class="language-plaintext highlighter-rouge">FlytePropeller</code>. It tries to push <code class="language-plaintext highlighter-rouge">FlyteWorkflow</code>, which is defined as a <code class="language-plaintext highlighter-rouge">Custom Resource Definition</code> in k8s, to the desired state leveraging k8s reconcile mechanism. The official document of Flyte has provided a pretty good <a href="https://github.com/flyteorg/flyte/blob/d2614d416cd2565dc6a91f0ccff63f7a0dbdf970/docs/concepts/component_architecture/flytepropeller_architecture.rst">high level architecture</a> on <code class="language-plaintext highlighter-rouge">FlytePropeller</code>’s design, here is a list of the core components:</p><ul><li><strong>Controller</strong>: overall brain of <code class="language-plaintext highlighter-rouge">FlytePropeller</code><li><strong>WorkQueue/WorkerPoll</strong>: where worker lives and take jobs to do, a very classic design in job scheduling system<li><strong>WorkflowExecutor</strong>: responsible for high-level workflow operations, such as tracking the status of workflow<li><strong>NodeExecutor</strong>: responsible for process the node within the workflow and decide the action need to take<li><strong>NodeHandler</strong>: different type of handler to execute different type of node in the workflow, e.g. TaskHandler for execute <code class="language-plaintext highlighter-rouge">Plugins</code> and WorkflowHandler to execute embedded sub-workflows</ul><p>Knowing what to do is one thing, and knowing how to do is another thing! Next, let’s jump into the code and see how these components are working internally and see how the logic defined within <code class="language-plaintext highlighter-rouge">Plugin</code> could be invoked.</p><h2 id="components-deep-dive"><span class="me-2">Components Deep Dive</span><a href="#components-deep-dive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="controller"><span class="me-2">Controller</span><a href="#controller" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Let’s get our journey starts with the <code class="language-plaintext highlighter-rouge">controller</code>. <code class="language-plaintext highlighter-rouge">Controller</code> is the starter for <code class="language-plaintext highlighter-rouge">FlytePropeller</code>, it is responsible for initializing other components:</p><ul><li>In the <code class="language-plaintext highlighter-rouge">New</code> function of <code class="language-plaintext highlighter-rouge">controller</code>, we would create <code class="language-plaintext highlighter-rouge">workqueue</code> <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/controller.go#L422">here</a>.<li>And then, we would create <code class="language-plaintext highlighter-rouge">workerpool</code> <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/controller.go#L461">here</a>. Note that <code class="language-plaintext highlighter-rouge">workerpool</code> requires the <code class="language-plaintext highlighter-rouge">workqueue</code> we have created before as part of its initialization (because worker needs to consume the jobs from the queue), and one <code class="language-plaintext highlighter-rouge">PropellerHandler</code><ul><li>notably, the <code class="language-plaintext highlighter-rouge">PropellerHandler</code> is <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/controller.go#L455">initialized with <code class="language-plaintext highlighter-rouge">WorkflowExecutor</code></a> and the <code class="language-plaintext highlighter-rouge">WorkflowExecutor</code> is <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/controller.go#L442-L455">composed of <code class="language-plaintext highlighter-rouge">NodeExecutor</code></a><li><code class="language-plaintext highlighter-rouge">NodeExecutor</code> requires a <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/controller.go#L436"><code class="language-plaintext highlighter-rouge">nodeHandlerFactory</code></a> as part of the construction</ul></ul><p>As of now, all the key components we have mentioned in the high level architecture is ready. We would go deeper into them to understand how are they getting invoked.</p><p>Besides the <code class="language-plaintext highlighter-rouge">New</code> function, there is also a <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/controller.go#L106"><code class="language-plaintext highlighter-rouge">run</code></a> function which plays a critical role on launching the <code class="language-plaintext highlighter-rouge">controller</code>. It launches things such as the <code class="language-plaintext highlighter-rouge">workerpool</code>, <code class="language-plaintext highlighter-rouge">gc</code> and <code class="language-plaintext highlighter-rouge">metrics monitors</code>. <code class="language-plaintext highlighter-rouge">run</code> function is called within another function <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/controller.go#L93-L103"><code class="language-plaintext highlighter-rouge">Run</code></a>, in <code class="language-plaintext highlighter-rouge">Run</code>, one interesting part is that it is going to leverage the <strong>leader election</strong> functionality provided by k8s and only let leader to trigger <code class="language-plaintext highlighter-rouge">run</code> function. We would discuss this topic more in details in a future post.</p><p>As the <code class="language-plaintext highlighter-rouge">controller</code> would launch <code class="language-plaintext highlighter-rouge">workerpool</code>, let’s then move our view to <code class="language-plaintext highlighter-rouge">workerpool</code> and <code class="language-plaintext highlighter-rouge">workqueue</code> to understand how these 2 components work.</p><h3 id="workerpoolworkqueue"><span class="me-2">WorkerPool/WorkQueue</span><a href="#workerpoolworkqueue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">workerpool</code> essentially is composed of <code class="language-plaintext highlighter-rouge">workqueue</code> and several <code class="language-plaintext highlighter-rouge">workers</code>, each are actually goroutines (this is also why Flyte could be pretty scalable on a single CPU, we would discuss this in the future). The <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workers.go#L128"><code class="language-plaintext highlighter-rouge">Run</code> function</a> in <code class="language-plaintext highlighter-rouge">workerpool</code> is the most critical function, which is the one get invoked by <code class="language-plaintext highlighter-rouge">controller</code>. The main logic is the <code class="language-plaintext highlighter-rouge">for loop</code> <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workers.go#L144-L153">here</a>, where we launch multiple goroutines and each goroutine would make a call to <code class="language-plaintext highlighter-rouge">runWorker</code> function. The <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workers.go#L113"><code class="language-plaintext highlighter-rouge">runWorker</code></a> function is relatively simple, just an endless while loop to call <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workers.go#L42"><code class="language-plaintext highlighter-rouge">processNextWorkItem</code></a> function. <code class="language-plaintext highlighter-rouge">processNextWorkItem</code> function gets an item from the <code class="language-plaintext highlighter-rouge">workqueue</code> and then <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workers.go#L89">invokes the <code class="language-plaintext highlighter-rouge">PropellerHandler</code></a> we perviously passed in during initialization. As we could see, the key processing logic resides within <code class="language-plaintext highlighter-rouge">PropellerHandler</code>’s <code class="language-plaintext highlighter-rouge">Handle</code> function, which is defined as part of the interface <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workers.go#L18-L23">here</a>, then let’s move on and see how this <code class="language-plaintext highlighter-rouge">Handle</code> works.</p><h3 id="propellerhandler"><span class="me-2">PropellerHandler</span><a href="#propellerhandler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/handler.go#L180"><code class="language-plaintext highlighter-rouge">Handle</code> function</a> defined by the <code class="language-plaintext highlighter-rouge">Propeller</code> struct is the entry point of the reconcile process (Here <code class="language-plaintext highlighter-rouge">Propeller</code> has implemented the <code class="language-plaintext highlighter-rouge">Handle</code> interface, thus it could be considered as type <code class="language-plaintext highlighter-rouge">Handler</code> although there is no explicit inherit, this is how interface implementation works in Golang). The key logic is within this <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/handler.go#L240-L249">for loop</a>, where we call <code class="language-plaintext highlighter-rouge">streak</code> function up to a max trial. The <code class="language-plaintext highlighter-rouge">streak</code> function would try to do a single mutation to workflow, and return the mutated workflow upon succeed, otherwise no update made if failed. The workflow here is the CRD <code class="language-plaintext highlighter-rouge">FlyteWorkflow</code> and the mutation operation is done via <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/handler.go#L298"><code class="language-plaintext highlighter-rouge">TryMutateWorkflow</code></a>. <code class="language-plaintext highlighter-rouge">TryMutateWorkflow</code> makes calls to <code class="language-plaintext highlighter-rouge">workflowExecutor</code>’s <code class="language-plaintext highlighter-rouge">HandleFlyteWorkflow</code> function to see if we could reconcile the workflow towards it desired status. We left out other details, such as how to handle failure, how to handle aborted workflow etc. From the code in <code class="language-plaintext highlighter-rouge">PropellerHandler</code>, we could observer that the <code class="language-plaintext highlighter-rouge">Handler</code> is just doing some high-level logic and the actual workflow processing logic is delegated to <code class="language-plaintext highlighter-rouge">workflowExecutor</code>. Now, let’s move to <code class="language-plaintext highlighter-rouge">workflowExecutor</code>.</p><h3 id="workflowexecutor"><span class="me-2">WorkflowExecutor</span><a href="#workflowexecutor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">HandleFlyteWorkflow</code> function called within <code class="language-plaintext highlighter-rouge">PropellerHandler</code> is a router function. It invokes other actual logic function based on the status of the workflow. For example, if the workflow status is in <code class="language-plaintext highlighter-rouge">WorkflowPhaseRunning</code>, then it would invoke <code class="language-plaintext highlighter-rouge">handleRunningWorkflow</code> function. In these functions, a common pattern is that they would setup the context, invoke <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workflow/executor.go#L175"><code class="language-plaintext highlighter-rouge">nodeExecutor</code>’s <code class="language-plaintext highlighter-rouge">RecursiveNodeHandler</code> function to get the new status</a> and then update the status. The new status is passed back and used to transit the workflow’s status (which is the reconcile process). Notice that the <code class="language-plaintext highlighter-rouge">FlyteWorkflow</code> is passed as parameters for <code class="language-plaintext highlighter-rouge">executors.DAGStructure</code> and <code class="language-plaintext highlighter-rouge">executors.NodeLookup</code>, as well as the <code class="language-plaintext highlighter-rouge">startNode</code>.</p><p>There is some different operation based on the new status <code class="language-plaintext highlighter-rouge">RecursiveNodeHandler</code> passed back. For example, if the new status is partial completed, then the workflow would be enqueue again and return <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/workflow/executor.go#L194-L197">running status</a>.</p><p>The <code class="language-plaintext highlighter-rouge">WorkflowExecutor</code> handles the operation of workflow and decided what action to take. In ML pipeline, we know that workflow is usually composed by several nodes, and these nodes encapsulate the actual computation. Let’s take a look at <code class="language-plaintext highlighter-rouge">nodeExecutor</code>, which is responsible for handling this part.</p><h3 id="nodeexecutor"><span class="me-2">NodeExecutor</span><a href="#nodeexecutor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/nodes/executor.go#L177"><code class="language-plaintext highlighter-rouge">RecursiveNodeHandler</code> function</a> is one of the most important function in <code class="language-plaintext highlighter-rouge">NodeExecutor</code>. It is the entry point to execute a node within a workflow. It uses actor model and modified version of DFS to traverse the DAG and to execute non-blocked nodes. Based on different status queried based on the starter node passed from input, it applies different logic to proceed. For example, if the node status is already succeed, skipped or recovered, then it would invoke <code class="language-plaintext highlighter-rouge">handleDownstream</code> function; while if the node is in status that could be handled, then the key logic happens <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/nodes/executor.go#L229-L234">here</a>: first, based on the node’s kind, a dedicated handler is retrieved from <code class="language-plaintext highlighter-rouge">nodeHandlerFactory</code>; then <code class="language-plaintext highlighter-rouge">HandleNode</code> function would be invoked to execute the node.</p><p>The <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/nodes/executor.go#L266"><code class="language-plaintext highlighter-rouge">handleDownstream</code></a> is where the aforementioned <em>modified DFS</em> implemented. The <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/nodes/executor.go#L269-L300">logic</a> is relatively straightforward: starting from the input node, we retrieve all downstream nodes; then we iterate each node and invoke the <code class="language-plaintext highlighter-rouge">RecursiveNodeHandler</code> function on each of them, with self as the new input start node; keep the status to check if all downstream nodes have been processed, and return the status accordingly.</p><p>The <code class="language-plaintext highlighter-rouge">HandleNode</code> function of <code class="language-plaintext highlighter-rouge">nodeExecutor</code> is also a router function, where different processing function is invoked based on the status of the current node. The most important functions are <code class="language-plaintext highlighter-rouge">handleQueuedOrRunningNode</code> and <code class="language-plaintext highlighter-rouge">handleNotYetStartedNode</code>:</p><ul><li>In the <a href="https://github.com/flyteorg/flyte/blob/96bbf7ed5331f7d629763a3721e90a1e35215da9/flytepropeller/pkg/controller/nodes/executor.go#L941"><code class="language-plaintext highlighter-rouge">handleNotYetStartedNode</code></a>, the most critic logic is the call to <code class="language-plaintext highlighter-rouge">preExecute</code>, where we check if the node could be queued to be further processed. The checking logic is relative simple, where we check the upstream nodes are all in succeed status or not<li>In the <code class="language-plaintext highlighter-rouge">handleQueuedOrRunningNode</code>, we would first try to check if there are cached result given the current handler, and <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/executor.go#L1132">trigger the <code class="language-plaintext highlighter-rouge">execute</code> function</a> if there is no cache hit. The core part of the <code class="language-plaintext highlighter-rouge">execute</code> function is to <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/executor.go#L828">trigger the <code class="language-plaintext highlighter-rouge">Handle</code></a> function of the input <code class="language-plaintext highlighter-rouge">NodeHandler</code>, which is obtained from <code class="language-plaintext highlighter-rouge">RecursiveNodeHandler</code> and passed along the stack <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/executor.go#L229">here</a>, what a long journey!</ul><p>Now, we have hit the most underground part of <code class="language-plaintext highlighter-rouge">FlytePropeller</code>’s architecture. Next, we need to dive into <code class="language-plaintext highlighter-rouge">NodeHandler</code> to understand how the <code class="language-plaintext highlighter-rouge">Handle</code> function is implemented (here we would focus on how the handler used to fulfill the operations we need in distributed training).</p><h3 id="nodehandler"><span class="me-2">NodeHandler</span><a href="#nodehandler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>From the section above, we know that we retrieve node handler from <code class="language-plaintext highlighter-rouge">nodeHandlerFactory</code> in <code class="language-plaintext highlighter-rouge">RecursiveNodeHandler</code>, through the <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/factory/handler_factory.go#L43"><code class="language-plaintext highlighter-rouge">GetHandler</code> function</a>. Here is a step by step explanation on how we trigger the logic defined within plugins:</p><ul><li>The <code class="language-plaintext highlighter-rouge">GetHandler</code> function returns node handler based on the type of the node. Most of training job is defined via <code class="language-plaintext highlighter-rouge">@task</code>, which is of <code class="language-plaintext highlighter-rouge">Task</code> type in Flyte<li><a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/factory/handler_factory.go#L64">Here</a> is the setup of the node handler for <code class="language-plaintext highlighter-rouge">Task</code> type. In Flyte, all <code class="language-plaintext highlighter-rouge">Task</code> is treated as a <code class="language-plaintext highlighter-rouge">dynamic</code> node and handle through <code class="language-plaintext highlighter-rouge">dynamic</code> node handler. However, we would still <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/factory/handler_factory.go#L52">pass a <code class="language-plaintext highlighter-rouge">task</code> node handler into <code class="language-plaintext highlighter-rouge">dynamic</code> node handler</a><li>In <code class="language-plaintext highlighter-rouge">dynamic</code> node handler’s <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/dynamic/handler.go#L175"><code class="language-plaintext highlighter-rouge">Handle</code> function</a>, by default, we would make a call to <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/dynamic/handler.go#L62"><code class="language-plaintext highlighter-rouge">handleParentNode</code></a>, and in this function, we would make a call to <code class="language-plaintext highlighter-rouge">TaskNodeHandler</code> interface’s <code class="language-plaintext highlighter-rouge">Handle</code> function<li>The logic of <code class="language-plaintext highlighter-rouge">task</code> node handler’s <code class="language-plaintext highlighter-rouge">Handle</code> function is pretty complex. First, it tries to <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/handler.go#L537">find the <code class="language-plaintext highlighter-rouge">Plugin</code> based on <code class="language-plaintext highlighter-rouge">task</code> type</a>; then if there is no cache hit on result, it would <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/handler.go#L583">invoke plugin</a><ul><li>Within <code class="language-plaintext highlighter-rouge">invokePlugin</code> function, the core part is to <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/handler.go#L397">invoke the <code class="language-plaintext highlighter-rouge">Handle</code> function</a><li><code class="language-plaintext highlighter-rouge">ResolvePlugin</code> search plugins through <code class="language-plaintext highlighter-rouge">pluginsForType</code>, where we initialized within the <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/handler.go#L280"><code class="language-plaintext highlighter-rouge">Setup</code> function</a>; the initialization is essentially sweeping the <code class="language-plaintext highlighter-rouge">enabledPlugins</code>, and we get it from <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/handler.go#L233"><code class="language-plaintext highlighter-rouge">WranglePluginsAndGenerateFinalList</code></a></ul><li>In <code class="language-plaintext highlighter-rouge">WranglePluginsAndGenerateFinalList</code> function, we get all plugins related to k8s through <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/plugin_config.go#L56"><code class="language-plaintext highlighter-rouge">PluginRegistryIface</code> interface</a>; in <code class="language-plaintext highlighter-rouge">task</code> node handler, there is a data member <code class="language-plaintext highlighter-rouge">pluginRegistry</code> of this type, and the construction is <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/handler.go#L912">here</a>, where we call the <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flyteplugins/go/tasks/pluginmachinery/registry.go#L23"><code class="language-plaintext highlighter-rouge">PluginRegistry</code> function</a> from <code class="language-plaintext highlighter-rouge">pluginMachinery</code> module<li>For each k8s plugin, <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/plugin_config.go#L56-L72">they would be wrapped within a <code class="language-plaintext highlighter-rouge">PluginEntry</code></a>, which is further <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/plugin_config.go#L68">wrapped in an object called <code class="language-plaintext highlighter-rouge">NewPluginManagerWithBackOff</code></a><li>All k8s plugin would use the <code class="language-plaintext highlighter-rouge">RegisterK8sPlugin</code> function within the module <code class="language-plaintext highlighter-rouge">pluginmachinery.register</code> to register them into the system. For example, the Pytorch Plugin is registered <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flyteplugins/go/tasks/plugins/k8s/kfoperators/pytorch/pytorch.go#L223">here</a>. However, all of these plugins actual do not provide a <code class="language-plaintext highlighter-rouge">Handle</code> function, which should be called by the node handler. What happened?<li>Actually, the <code class="language-plaintext highlighter-rouge">Handle</code> function is implemented within <code class="language-plaintext highlighter-rouge">PluginManager</code>. Since <code class="language-plaintext highlighter-rouge">PluginManager</code> <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flyteplugins/go/tasks/pluginmachinery/core/plugin.go#L45">implement all interface defined in <code class="language-plaintext highlighter-rouge">pluginCore.plugin</code></a>, we could treat <code class="language-plaintext highlighter-rouge">PluginManager</code> as a plugin to invoke (this is a class <strong>Strategy</strong> design pattern, where <code class="language-plaintext highlighter-rouge">PluginManager</code> defines the main logic and expressed via several step functions. And we could use composition to fulfill these step functions with different implementation)<li>Within the <code class="language-plaintext highlighter-rouge">Handle</code> function in <code class="language-plaintext highlighter-rouge">PluginManager</code>, we would check the current status, if the status is not started, then we would call <code class="language-plaintext highlighter-rouge">launchResource</code>, otherwise we would call <code class="language-plaintext highlighter-rouge">getResource</code> and <code class="language-plaintext highlighter-rouge">checkResourcePhase</code> to obtain new transition information<ul><li>In <code class="language-plaintext highlighter-rouge">launchResource</code> function, we would call <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/k8s/plugin_manager.go#L199"><code class="language-plaintext highlighter-rouge">BuildResource</code></a> function which is defined in the plugin. This function is used to <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flyteplugins/go/tasks/plugins/k8s/kfoperators/pytorch/pytorch.go#L133-L139">construct a kubeflow job</a>. Then it <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/k8s/plugin_manager.go#L220">make a <code class="language-plaintext highlighter-rouge">create</code> request via <code class="language-plaintext highlighter-rouge">kubeClient</code></a> to create this resource<li>In <code class="language-plaintext highlighter-rouge">checkResourcePhase</code>, we would <a href="https://github.com/flyteorg/flyte/blob/7d59f106db997ab22686b1b414228fe323934c48/flytepropeller/pkg/controller/nodes/task/k8s/plugin_manager.go#L283">call <code class="language-plaintext highlighter-rouge">GetTaskPhase</code></a> to get the current status of the job<li>Here is the point where Flyte is leveraging kubeflow and k8s to request resource and start the training job; both kubeflow and k8s would be huge topics, and I plan to discuss more in details in separate blog</ul></ul><p>Here, we reach the end of our journey and the remaining job is delegated to k8s. What a complex flow!</p><h2 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this post, we focus our discussion on how Flyte would invoke the distributed training job which is defined through plugin, we could see some common practice that is adopted in the design, such as utilization of queue and multithreading for scalability; separation of workflow executor and node executor for single responsibility principle; factory design for extensibility, etc.</p><p>In next topic, we would focus on the storage used in Flyte, which is also another critical component, as we need to store the status of the workflow, node and even intermediate result; as well as leveraging caching to speed up the execution by avoiding duplicated computation. Once we have a better understanding on the storage part, we could start to evaluate the availability, scalability and persistence of Flyte.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/distributed-system/">Distributed System</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/open-source/" class="post-tag no-text-decoration" >open source</a> <a href="/tags/job-scheduler/" class="post-tag no-text-decoration" >job scheduler</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=How%20Workflow%20Get%20Scheduled%20via%20Plugins%20in%20Flyte%20-%20Coding%20Monkey&url=https%3A%2F%2Fpyemma.github.io%2FFlyte-How-Workflow-Get-Scheduled%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=How%20Workflow%20Get%20Scheduled%20via%20Plugins%20in%20Flyte%20-%20Coding%20Monkey&u=https%3A%2F%2Fpyemma.github.io%2FFlyte-How-Workflow-Get-Scheduled%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fpyemma.github.io%2FFlyte-How-Workflow-Get-Scheduled%2F&text=How%20Workflow%20Get%20Scheduled%20via%20Plugins%20in%20Flyte%20-%20Coding%20Monkey" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/Recsys-Paper-Review-2025-Q1/">Recsys Paper Summary 2025 Q1</a><li class="text-truncate lh-lg"> <a href="/How-to-design-slack/">How to Design Slack</a><li class="text-truncate lh-lg"> <a href="/Features-in-Recommendation-System/">那些年，我们追过的 Feature</a><li class="text-truncate lh-lg"> <a href="/How-to-design-online-chess-game/">How to Design Online Chess Game</a><li class="text-truncate lh-lg"> <a href="/Recsys-2024-Paper-Summary/">Recsys 2024 Paper Summary</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/machine-learning-design/">machine learning design</a> <a class="post-tag btn btn-outline-primary" href="/tags/system-design/">system design</a> <a class="post-tag btn btn-outline-primary" href="/tags/distributed-system/">distributed system</a> <a class="post-tag btn btn-outline-primary" href="/tags/embeddings/">embeddings</a> <a class="post-tag btn btn-outline-primary" href="/tags/llm/">llm</a> <a class="post-tag btn btn-outline-primary" href="/tags/message-queue/">message queue</a> <a class="post-tag btn btn-outline-primary" href="/tags/realtime-system/">realtime system</a> <a class="post-tag btn btn-outline-primary" href="/tags/sparse-features/">sparse features</a> <a class="post-tag btn btn-outline-primary" href="/tags/stateful-service/">stateful service</a> <a class="post-tag btn btn-outline-primary" href="/tags/auction/">auction</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/How-to-design-slack/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1738396800" data-df="ll" > Feb 1, 2025 </time><h4 class="pt-0 my-2">How to Design Slack</h4><div class="text-muted"><p>In this post, I would like to discuss how to build slack, a very popular realtime messaging application, especially for group messaging (a.k.a channel) in cooperation messaging scenario. Functiona...</p></div></div></a></article><article class="col"> <a href="/How-to-design-online-chess-game/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1728543600" data-df="ll" > Oct 10, 2024 </time><h4 class="pt-0 my-2">How to Design Online Chess Game</h4><div class="text-muted"><p>I have been a fan of online game since my parent bought me a PC when I was in 5th grade. I could still feel the excitement when every Thursday night I rushed home and played DaHuaXiYou 2 with my fr...</p></div></div></a></article><article class="col"> <a href="/Book-Pattern-of-Distributed-System/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1720162800" data-df="ll" > Jul 5, 2024 </time><h4 class="pt-0 my-2">读书笔记 - Patterns of Distributed System</h4><div class="text-muted"><p>最近读了一本和 distributed system 相关的书籍，介绍了在 distributed system 里面常用的一些 pattern. 这是一篇简要的读书笔记，把书中提到的几个 pattern 总结了下来; 我计划会经常更新这篇 blog, 把我新学习到的或者总结出来的一些 pattern 记录在这里; 希望能起到一个引导性的作用，给大家提供一个提纲挈领的思路 Patterns...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/LLM-LLM-Training-101/" class="btn btn-outline-primary" aria-label="Older" ><p>LLM Training 101</p></a> <a href="/How-to-design-online-chess-game/" class="btn btn-outline-primary" aria-label="Newer" ><p>How to Design Online Chess Game</p></a></nav><div id="disqus_thread"><p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://pyemma.github.io/Flyte-How-Workflow-Get-Scheduled/'; this.page.identifier = '/Flyte-How-Workflow-Get-Scheduled/'; };var disqus_observer = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://pyemma.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] } ); disqus_observer.observe(document.getElementById('disqus_thread'));function reloadDisqus() { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } if (document.getElementById('mode-toggle')) { window.addEventListener('message', reloadDisqus); } </script><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/pyemma">Coding Monkey</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/machine-learning-design/">machine learning design</a> <a class="post-tag btn btn-outline-primary" href="/tags/system-design/">system design</a> <a class="post-tag btn btn-outline-primary" href="/tags/distributed-system/">distributed system</a> <a class="post-tag btn btn-outline-primary" href="/tags/embeddings/">embeddings</a> <a class="post-tag btn btn-outline-primary" href="/tags/llm/">llm</a> <a class="post-tag btn btn-outline-primary" href="/tags/message-queue/">message queue</a> <a class="post-tag btn btn-outline-primary" href="/tags/realtime-system/">realtime system</a> <a class="post-tag btn btn-outline-primary" href="/tags/sparse-features/">sparse features</a> <a class="post-tag btn btn-outline-primary" href="/tags/stateful-service/">stateful service</a> <a class="post-tag btn btn-outline-primary" href="/tags/auction/">auction</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-M1GM2SJR6M"></script> <script> document.addEventListener('DOMContentLoaded', function (event) { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-M1GM2SJR6M'); }); </script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
